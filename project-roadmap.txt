X Walkability grid generation

X Block vision grid

ğŸ”² Lighting system (torches, lanterns, etc)

X FOV reveal overlay

ğŸ”² Interaction with "dynamic" tiles like doors

======================

ğŸ§± Next Steps in the Dev Pipeline:
We're entering the Lighting & Field of View (FOV) zone:

1. Store/track walkability and visibility data
Weâ€™ll use the build_walkability_grid() output to power FOV + lighting logic.

Could store this grid in memory per loaded map (not JSON yet unless we need persistence).

2. Setup FOV system
Use something like shadowcasting or recursive raycasting (Godot-friendly).

Based on blocks_vision from terrain/objects.

Player gets visible area grid after moving.

3. Basic Lighting Overlay
Add a ColorRect or shader overlay for darkness.

Remove darkness from visible tiles based on FOV.

Add a â€œlight radiusâ€ to the player (e.g. lanterns).

======================

ğŸ—º Recommended Phased Plan
âœ… Phase 1: Terrain/Object Collision
Add a is_tile_walkable(x, y) helper.

Add NON_WALKABLE_TERRAINS and NON_WALKABLE_OBJECTS in Constants.

Block movement before updating position.

ğŸŒ˜ Phase 2: Light/Dark Overlay (Time of Day)
Add a ColorRect node that adjusts opacity based on miltime.

No need for complex lighting yet.

Could add torch/lamp logic later.

ğŸ”¦ Phase 3: Basic FOV
Raycast out from playerâ€™s tile in all 8 directions up to light_radius.

Stop on walls/objects that block vision.

Stop on walls/objects that block vision.
ğŸ‘€ Phase 4: Advanced FOV + Light Sources
Add torches, lanterns, and buildings with windows.

Each light source gets its own radius and casts light.

NPCs outside of your visible radius are hidden from view.

ğŸ§ Phase 5: NPC Movement + Visibility
Only show and update NPCs that are visible.

Movement runs after player turn ends.

Eventually, they could have their own FOV too.

=====================================
TECH TO LOOP ROADMAP
=====================================

ğŸ§± CURRENT STAGE: Tech Foundation
Milestone 0: Lighting & FOV Integration

 âœ… build_walkability_grid() provides blocks_movement and blocks_vision

 âœ… Consts.is_blocking_vision() uses terrain + object data

 ğŸ”„ Implement FOV algorithm (start with recursive shadowcasting or Bresenham rays for simplicity)

 ğŸ’¡ Create a tile-level visibility_map, refreshed on player move

 ğŸ¨ Dark overlay via shader or modulated ColorRect/TileMap layer

 ğŸ”¦ Add player "light source radius"

Once this is in, the fog-of-war and darkness will support exploration and survival loops. Youâ€™re gonna feel the wilderness.

ğŸ£ Milestone 1: Minimal Viable Angler Loop (Wilderness Survival)
Goal: Simulate basic survival in wild â€” move, gather, craft, eat, sleep.

ğŸŒ¿ Core Systems:
 Implement interactable object logic (bushes, rocks) â†’ right-click or action-key triggers

 Add â€œgatherableâ€ prefab logic (maybe tag with "gatherable": true in object JSON)

 Basic component item system (wood, stone, fiber) into inventory

ğŸ› ï¸ Crafting Foundation:
 UI for selecting craftables (or just a debug menu for now)

 Load crafting_recipes.json with inputs/outputs

 Crafting requires components + (optionally) tool-in-hand

ğŸ£ Basic Gear:
 Axe (gather faster / chop-only objects)

 Rod (required to fish)

 Knife (required to butcher)

 Shovel (dig for worms)

 Hammer (required for building)

ğŸŸ Core Interactions:
 Fishing spot prefab (water tile + "fishing hotspot" overlay)

Fish only if rod in hand

Mark tile as â€œexploitedâ€ after use (flag in metadata)

 Worm digging (only at specific soil tiles, with shovel)

 Campfire placement (consume wood + stone)

Accepts fish_meat to create cooked_fish

 Shelter prefab placement (provides sleep location)

ğŸ½ï¸ Basic Needs:
 Hunger / thirst stat ticking over time

 â€œEatâ€ and â€œDrinkâ€ actions from inventory

 Sleeping system (skip time, restore energy, maybe animal encounter chance)

ğŸ§­ Loop Closure:
 Vendor prefab (fishing market in a nearby realm/city)

Sells gear (better rod, lures)

Buys cooked fish

 Add marker/reminder system (bookmark or note camp location)

 Realm transition system for city â†’ market

At this stage, the player can explore â†’ gather â†’ craft â†’ survive â†’ sell â†’ repeat. Thatâ€™s the tight core of the Angler loop.

ğŸ” Milestone 2: Expand & Polish
Once that loop is working:

 Introduce random events (weather, animal encounters at night)

 Add durability to tools (force maintenance loop)

 Add more fish types, bait, and biome-based fishing logic

 Expand towns with more vendor types (gear progression)

 Build "loop scale": can the player sustain indefinitely and upgrade?

ğŸ“¦ Suggested Structure Updates (non-blocking, for later)
interactables/ â†’ JSON data per object type defining behavior (searchable, gatherable, searchable once)

crafting/recipes.json â†’ formalizes all recipes (component â†’ product)

needs_system.gd â†’ tracks player hunger, thirst, fatigue

interaction_handler.gd â†’ a flexible system for object use

==============================

ğŸ§± Milestone 0 (Shared Foundation â€” Already In Progress or Useful to Both)
âœ… build_walkability_grid() + FOV groundwork â€” covers both wilderness and urban traversal

âœ… Terrain + Object logic centralized in Consts.gd â€” solid move, this'll make interactions sane

âœ… Prefab + ObjectLayer system â€” easily allows tagging/flagging urban junk vs nature interactables

ğŸ”„ (Soon) Visibility system + tile darkness + player light radius

ğŸ”„ Interaction system (suggest making it generic: interact(obj, player) with data-driven responses)

ğŸ”„ Inventory + component items foundation

This is the base that all loops build off. Youâ€™re in a strong place here.

ğŸšï¸ Milestone 1: Core Junkman Loop â€” Urban Survival
Goal: Survive in a slum biome with scavenging, basic crafting, and dangerous nights.

ğŸ—‘ï¸ Urban Biomes & Interactables
 Add garbage can prefabs with "searchable": true, "once_only": true tags

 Add junk pile / alley furniture prefabs

 Randomized loot table per object type (use weighted RNG: rags common, gold ring rare)

 Sewer entrances as local map transitions (mini-dungeons) - prevent exploitation (sewer rerolling every entry, you need to go to a new slum biome, not reroll the same over and over)

 Designate unsearchable once searched (add "searched": true metadata to tile or object ID)

ğŸ§  Note: Use the same interactables system as bushes and fishing spots â€” just different flags & loot tables.

ğŸ› ï¸ Urban Crafting
 Scrap item types: broken_furniture, scrap_metal, rags, glass

 Add â€œworkbenchâ€ tag to specific slum interior objects

Canâ€™t craft advanced tools (axe, hammer) without workbench

Could extend crafting UI to check "required_station" field in recipe

 Junk tools: axe, spear, hammer from scrap + wood

ğŸ” Same crafting system from Angler; just different recipes and materials.

ğŸ€ Sewer Loop & Combat
 Sewer generator scene with rat spawns (connect via sewer entrance prefab)

 Rat AI: simple path-to-player, maybe â€œambushâ€ behavior from darkness

 Spear combat (throwable or melee)

 Rats drop rat_carcass â†’ can be butchered to rat_meat

ğŸ³ Urban Cooking & Survival
 Oil drum stove prefab (in alleys / sewer / camps)

Consumes wood, cooks rat_meat â†’ cooked_rat

 Hobo camp prefabs:

Allow sleeping, but add sleep_event_chance like â€œwake up robbedâ€ or â€œrat attackâ€

Add "public": true flag for camps that anyone can use (vs player-claimed)

ğŸ  Home Claiming System
 Explore city and find tagged claimable_structure (abandoned apartments, ramshackles)

 Add "is_claimed": false to prefab metadata

 Claim if carrying a "cheap_lock" item

Sets "is_claimed": true, marks location on world map

 Claiming adds ability to build there (see below)

ğŸ§± Building in Urban Spaces
 Build mattress, stove, maybe container storage (future)

 Like wilderness building â€” but different recipes + uses

Requires hammer + components

ğŸ“ˆ Junkman Loop Closure
 Add junk vendor (buys scrap, sells tools, lock)

 Explore city to find locksmith â†’ buy cheap_lock

 Return to claimed spot, build up base

 Loop becomes: explore â†’ scavenge â†’ craft â†’ survive â†’ upgrade base â†’ repeat

ğŸ§  Systems to Think Ahead On (Shared, Modular-Friendly Ideas)
Feature	Notes
interactables.json	Let every object define "interact_type": "gather", "search", "fish", "cook", etc.
loot_tables.json	Give prefabs loot pools so objects donâ€™t hardcode drops
player_stats.gd	Track hunger, thirst, fatigue, sickness
random_events.gd	Handles night events, combat ambushes, etc
realm_registry.gd	Let you track which locations have been â€œrememberedâ€ or claimed
furniture.json	Data-driven placeable objects, whether shelter or ragpile
ğŸ’¡ Milestone 2: Early Emergent Storytelling
Once youâ€™ve got one loop mostly working (Angler or Junkman), youâ€™ll be in a spot where:

Players are choosing how to survive

Exploration reveals new things over time

Light crafting/economy creates goals

Claiming space creates an emotional link

This is the point where you can start layering in:

Weather systems

NPCs with light schedules

Vendors that change by biome

Multiple loop paths in parallel

========================

 ALPHA POLISH CHECKLIST
ğŸ—‚ï¸ Organized by category. Goal: Functional, understandable, and engaging first experience.

ğŸ® Gameplay Flow
 â³ Core loops are completable (Angler/Junkman both have self-contained gather > craft > sell > survive > repeat)

 ğŸ§­ Onboarding is intuitive (optional signs, tutorials, or contextual prompts)

 ğŸ”„ Interaction feedback is obvious (popups, sound, animation, or message logs)

 ğŸ§± Resource loops are balanced (not too grindy, not trivial â€” test time-to-gear milestones)

ğŸŒ World Interactions
 ğŸ§º Gatherables work consistently (bushes, junk piles, etc. clear interaction states)

 ğŸšª Realm transitions are seamless (no stutter, state loss, or map bugs)

 ğŸª“ Tool gating is enforced (you canâ€™t fish without a rod, dig without a shovel, etc)

 ğŸ“ Map memory is functional (player can find claimed shelter, vendor, or sewer)

ğŸ”¥ FOV & Lighting
 ğŸ”„ FOV updates on move (instant or smoothed â€” no visual lag)

 ğŸŒ‘ Darkness feels immersive (tiles are clearly visible/invisible, not confusing)

 ğŸ”¦ Player light radius works (dynamically updates with gear changes, night/day cycle)

 ğŸ§Ÿ Enemies respect visibility (rats only aggro if playerâ€™s visible or within range)

ğŸ›ï¸ UI/UX Polish
 ğŸ’ Inventory UI is usable (drag/drop, tooltips, component count visibility)

 ğŸ› ï¸ Crafting UI is readable (inputs clear, missing requirements obvious)

 ğŸ“œ Message log or feedback system (You searched. You found x. You can't do y.)

 ğŸ›ï¸ Sleep/cook/interact UIs use context-sensitive menus or prompts

ğŸ› Debugging / Dev Tools
 ğŸ Dev console / cheat hotkeys (spawn item, fast travel, toggle night, etc)

 ğŸ§° Clear log output (errors show location or type)

 ğŸ§ª Stress test edge cases (search same object twice, realm swap mid-action, etc)

ğŸ’¾ Save/Load Systems
 ğŸ’¡ Save is automatic or player-triggered

 ğŸ” Loading respects current slot system

 ğŸ” Map and object states persist (searched garbage stays searched, player health retained)

 ğŸ§± Structure placements saved/rebuilt (campfires, shelters, claimed zones)

ğŸ”Š Audio/Visual Polish
 ğŸ”” Sound cues for interact, craft, combat, gather

 ğŸŒ— Lighting transitions (fade in/out when entering new area or sleeping)

 ğŸ§ Character animations or feedback (e.g. â€œgatherâ€ animation even if simple)

ğŸ“¢ Alpha Experience / Player Feedback
 ğŸ§ª Playtest sessions planned (target early feedback from a few trusted folks)

 ğŸ§¾ Bug/feedback report method (in-game or out-of-game)

 ğŸ§  First 10 mins of gameplay is curated (slow ramp-up, no overwhelming menus)

âœ… ALPHA DONE WHEN:
â€œA player can enter the world and survive in wilderness or city by being a combination or dedicated Angler or Junkman, enter the world, explore their biome, gather items, craft basic gear, survive a few nights, sell/find value, and feel like theyâ€™ve started something.â€